flowchart LR
  A["Upload PDF"] --> B["Extract Text using PyMuPDF (fitz)"]
  B --> C{"Text Extracted?"}
  C -->|"No"| D["Show Error: Failed to Extract Text"]
  C -->|"Yes"| E["Structure Text into Sections"]
  E --> F["(Optional) Chunk & Embed Sections -> FAISS Index"]
  F --> G["Load Local DeepParse Model (cached)"]
  G --> H["User Asks a Question"]
  H --> I["Retrieve top-k chunks (if using RAG) or use selected sections"]
  I --> J["Construct Prompt from Sections + Question"]
  J --> K["Generate Answer (Model Inference)"]
  K --> L["Display Answer to User"]
  L --> M["Generate Follow-up Questions"]
  M --> N["Show Follow-up Questions"]
  subgraph Notes
    direction LR
    X["Model files download once to HF cache"] --> Y["Streamlit caches pipeline instance (st.cache_resource)"] 
  end
